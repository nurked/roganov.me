---
import PageLayout from './PageLayout.astro';
import { useTranslations, getLocalePath, getAlternateLang } from '../i18n/utils.js';

interface Props {
  title: string;
  date: Date;
  description: string;
  lang: string;
  slug: string;
  tags?: string[];
}

const { title, date, description, lang, slug, tags } = Astro.props;
const t = useTranslations(lang);
const altLang = getAlternateLang(lang);
---

<PageLayout
  title={`${title} | Blog`}
  description={description}
  lang={lang}
  canonicalPath={getLocalePath(lang, `blog/${slug}/`)}
  alternateLangPath={getLocalePath(altLang, `blog/${slug}/`)}
  alternateLang={altLang}
>
  <article class="max-w-3xl mx-auto px-4 py-16">
    <header class="mb-8">
      <h1 class="text-4xl font-bold text-white mb-2">{title}</h1>
      <time class="text-gray-500" datetime={date.toISOString()}>
        {t('blog.publishedOn')}: {date.toLocaleDateString(lang === 'ru' ? 'ru-RU' : 'en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
        })}
      </time>
      {tags && tags.length > 0 && (
        <div class="flex gap-2 mt-3">
          {tags.map((tag) => (
            <span class="text-sm bg-white/5 border border-white/10 text-gray-400 px-3 py-1 rounded-lg">{tag}</span>
          ))}
        </div>
      )}
    </header>

    <div class="prose prose-lg prose-dark max-w-none">
      <slot />
    </div>

    <footer class="mt-12 pt-8 border-t border-white/10">
      <a href={getLocalePath(lang, 'blog/')} class="text-brand-light hover:text-brand-accent transition-colors">
        &larr; {t('blog.backToBlog')}
      </a>
    </footer>
  </article>
</PageLayout>
